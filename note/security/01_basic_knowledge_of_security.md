# セキュリティの基礎知識


## セキュリティの重要性

インターネットの発展はその利便性にあるが、その一方で利便性の一部を犠牲にしてセキュリティを確保する必要がある。現代ではこの利便性と安全性のトレードオフが非常に重要となっている。

### サイバーセキュリティ

**サイバーセキュリティ**とは、関係のない第三者への情報漏洩を防止し、情報システム及び通信ネットワークの安全性、信頼性を確保するため、必要な措置が取られ、適切に維持管理されていること。

ネットワーク経由でコンピュータに侵入して機密情報を盗んだり、サーバーやシステムを攻撃・停止させてサービスの提供を不能にしたり、ホームページやファイルの内容を改ざんしたり、他システムへの攻撃の踏み台にしたり、といった行為のことを**サイバー攻撃**という。

近年はサイバー攻撃の組織化が進み、サイバー犯罪者は**ダークウェブ**と呼ばれるアンダーグラウンドで連絡を取り合ってマーケットを形成している。

**マルウェア**は様々な悪意のあるソフトウェアの総称で、コンピュータウィルスなどもマルウェアの一種。

**ランサムウェア**は、システムやファイルを暗号化して人質に取り、金銭を要求するという手法である。

**スパイウェア**は、利用者の同意があってインストールされるマルウェアの一種。フリーソフトなどのインストール時に表示される使用許諾契約書を読み飛ばしたことにより意図せずインストールされてしまう場合がある。

**標的型攻撃**では、特定の組織内の機密情報を狙うサイバー攻撃である。中でも、持続的に攻撃を行う手法を**APT攻撃**（Advanced, Persistent, Threat）と呼ぶ。また、**サイバーキルチェーン**と呼ばれるモデルでは、攻撃を7つの段階に分類して行う。

サイバーセキュリティ対策として、リスク管理体制を整えて、**SOC**（Security Operation Center）や**CSIRT**（Computer Security Incident Response Team）を設置する企業も増えている。

サイバー攻撃を受けた際に、ハードディスクやUSBメモリ、スマートフォンなどに残る証拠となる電子データを収集し、検査、分析、報告を行うことを**デジタル・フォレンジック**と呼ぶ。


## セキュリティの構成要素

### ファイアウォール

**ファイアウォール**は、組織内部のネットワークを不正アクセスから守るために設置される。規定されたパケットのみを通過させる（またはさせない）**パケットフィルタリングタイプ**や、アプリケーションを介在させて不正な接続を遮断する**アプリケーションゲートウェイタイプ**がある。

### 侵入検知システム、侵入防止システム

ファイアウォールでは、ポリシーと合致した通信であれば悪意のある通信であっても通過させてしまう。このような通信や、いったん内部に侵入してから不正アクセスを行う通信などを見つけ、セキュリティ管理者などに通知するのが**IDS**（Intrusion Detection System、侵入検知システム）である。

一方で**IPS**（Intrusion Prevention System、侵入防止システム）には、ネットワークの監視や異常検知機能に加えて、不正侵入を防御する機能がある。

### DMZ

インターネットに接続されたネットワークにおいて、インターネットから直接通信できる専用のサブネットを用意して、そこにサーバーを設置する場合がある。この、外部からも内部からも隔離された専用のサブネットを**DMZ**（DeMilitarized Zone、非武装地帯）という。

### WAF

**WAF**（Web Application Firewall）は、ウェブアプリケーションの脆弱性を悪用する攻撃から守るためのセキュリティ対策。ファイアウォールやIDS/IPSでは検知が難しい、**SQLインジェクション**や**クロスサイトスクリプティング**、**パラメータ改ざん**といったアプリケーションレベルでの攻撃を検知して防ぐことができる。

### アンチウィルス、パーソナルファイアウォール

**アンチウィルス**と**パーソナルファイアウォール**は、IDS/IPS、ファイアウォールに次ぐセキュリティ対策。ユーザが利用するコンピュータや、サーバーなどで動作するセキュリティソフトウェア。コンピュータを出入りするパケットやデータ、ファイルなどを監視して、不正な処理やウィルスの侵入を防ぐ。

このようなアンチウィルスを含む包括的なセキュリティ対策を包括して、**エンドポイントセキュリティ**という。

### コンテンツセキュリティ

E-mailやWebでは、不正なメールを受信させたり、不正なWebサイトへ誘導してマルウェアを仕込んだWebページの表示やコンテンツのダウンロードを行わせる方法（**水飲み場攻撃**）などが行われる。

サーバーとクライアントの間に、セキュリティ対策用のSMTPサーバーやプロキシサーバーを設置し、セキュリティチェックを行う。


## 暗号化技術の基礎

### 共通鍵暗号方式と公開鍵暗号方式

**暗号化**では、ある値（鍵）を用意して、その鍵を使って元のデータ（平文）に対して一定のアルゴリズム返還を行い、暗号化データ（暗号文）を作る。

**共通鍵暗号方式**では、暗号化と復号に同じ鍵を用いる。 鍵を知られると復号されてしまうので、安全な鍵の受け渡しが課題となる。暗号化方式には、**AES**（Advanced Encryption Standard）や**DES**（Data Encryption Standard）がある。

**公開鍵暗号方式**では、一対の別々の鍵（公開鍵と秘密鍵）を用いる。公開鍵を知られても暗号分の復号は行えないため、秘密鍵を厳重に保管しておけばよい。公開鍵はWeb上で公開したり、**PKI**（Public Key Infrastructure、公開鍵基盤）を利用して配布したりする。暗号化方式には、**RSA**や**DH**（Diffie-Hellman）、**楕円曲線暗号**などがある。

PKIは、通信の相手が本物かどうかを、信頼できる第三者に証明してもらうための仕組み。この信頼できる第三者のことを**認証局**（**CA**、Certificate Authority）と呼び、利用者はCAが発行する**証明書**により通信相手が本物かを確かめる。

### 認証技術

セキュリティ対策上、利用者が正当な利用者であるかを識別するため、暗号化とともに利用されるのが認証技術である。

各種の端末やサーバー、アプリケーションなどの認証、認可を総合的に管理することを目的とした**アイデンティティ管理**（Identity Management）技術が注目されている。これにより、一度認証されるだけで複数の異なるアプリケーションやシステムへアクセスできるようになる、**シングルサインオン**が可能になる。

また、クラウドサービスの利活用が進むとともに、**認証連携**（**フェデレーション**）の重要性が高まっている。認証連携の標準規格としては、**OpenID**や**OAuth**、SAMLなどがある。OpenIDは、あるWebサービス（Identity Provider、IdP）のアカウントをほかのWebサービス（Service Provider、SP）に提供する方式。OAuthは、あるWebサービス（Service Provider）のデータをほかのWebサービス（Consumer）から利用できるようにするための仕様。

### 改ざん対策

公開鍵暗号方式の応用として、作成された電子情報が改ざんされていないことを証明するための仕組みがある。

**フィンガープリント**は、ハッシュ関数を使って作成したハッシュ値のこと。データが改ざんされた場合、再度ハッシュ値を計算して元のフィンガープリントの値と比較することで、改ざんされていることがわかる。

**デジタル署名**は、送信されてきた電子情報のデータが改ざんされておらず、本人のものであることを確認できる技術。データのフィンガープリントを公開鍵暗号方式でやり取りすることで実現している。

**タイムスタンプ**は、電子データがある日時に存在していたこと、およびその日時以降に改ざんされていないことを証明できる技術。 フィンガープリントと時刻情報を合わせた、タイムスタンプトークンを利用する。


## セキュリティのためのプロトコル

### VPNとIPsec

**VPN**（Virtual Private Network）は、インターネットを利用した仮想的な私的ネットワークのこと。
VPNを構築するときに最も一般的に利用されているのが、**IPsec**である。

IPsecでは、IPヘッダの後ろに、**暗号ヘッダ**（**ESP**、Encapsulating Security Payload）と**認証ヘッダ**（**AH**、Authentication Header）をつける。暗号ヘッダ以降のデータを暗号化することで、解読できないようにしている。IPsecには、**トランスポートモード**（Transport Mode）と**トンネルモード**（Tunnel Mode）がある。

ESPは暗号化に関するヘッダ拡張、AHは認証に関するヘッダ拡張で、パケットが改ざんされていないことを保証する。ESPとAHのためには共通鍵が必要となり、その方法は**IKE**によって規定されている。

IPsecを使ってお互いに通信する機器は同等（ピア）の関係となり、IPsecピア間で**SA**（Security Association）と呼ばれる単方向のコネクションを確立する。

### TLS、SSlとHTTPS

Webでは**TLS/SSL**（Transport Layer Security / Secure Sockets Layer）という仕組みを使ってHTTP通信の暗号化が行われる。こうして暗号化された通信を**HTTPS**（HTTP Secure）と呼ぶ。

TLS/SSLでは、公開鍵暗号方式により共通鍵を送信して、共通鍵暗号方式によって暗号化処理が行われる。公開鍵が正しいかどうかの確認には、認証局から発行された証明書を使う。さらに、ハッシュ用共通鍵に基づく改ざん検知機能が実装されている。

TLS/SSLを利用した**リモートアクセスVPN**という仕組みもあり、**SSL-VPN**とも呼ばれる。
