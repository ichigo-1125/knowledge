# REST


## 目次

1. [アーキテクチャスタイル](#アーキテクチャスタイル)
	1. [アーキテクチャスタイルとデザインパターン](#アーキテクチャスタイルとデザインパターン)
	1. [RESTアーキテクチャスタイル](#restアーキテクチャスタイル)
1. [リソース](#リソース)
	1. [アドレス可能性](#アドレス可能性)
	1. [リソースの表現と状態](#リソースの表現と状態)
1. [RESTアーキテクチャスタイル](#restアーキテクチャスタイル)
	1. [クライアント/サーバ](#クライアントサーバ)
	1. [ステートレスサーバ](#ステートレスサーバ)
	1. [キャッシュ](#キャッシュ)
	1. [統一インタフェース](#統一インタフェース)
	1. [階層化システム](#階層化システム)
	1. [コードオンデマンド](#コードオンデマンド)
	1. [ULCODC$SS](#ulcodcss)
1. [RESTful](#restful)
	1. [RESTfulサービス](#restfulサービス)


## アーキテクチャスタイル

### アーキテクチャスタイルとデザインパターン

**アーキテクチャスタイル**は（マクロ）アーキテクチャパターンとも呼ばれ、複数のアーキテクチャに共通する性質、様式、作法あるいは流儀を指す言葉。アーキテクチャスタイルには、**MVC**（Model-View-Controller）や**パイプ&フィルタ**（Pipe and Filter）、**イベントシステム**（Event System）などがある。

**デザインパターン**はマイクロアーキテクチャパターンとも呼ばれ、アーキテクチャスタイルよりも**粒度**の小さいクラスなどの設計仕様を指す。**GoF**（Gang of Four）の23種類のデザインパターンが有名。

### RESTアーキテクチャスタイル

RESTはネットワークシステムのアーキテクチャスタイルであり、**クライアント/サーバ**に制約を加えたものとなっている。RESTはWeb全体のアーキテクチャスタイルでもあり、個別のサービスのアーキテクチャスタイルでもある。

| 抽象化レベル           | Webでの例                                   |
| ---------------------- | ------------------------------------------- |
| アーキテクチャスタイル | REST                                        |
| アーキテクチャ         | ブラウザ、サーバ、プロキシ、HTTP、URI、HTML |
| 実装                   | Apache、Firefox、Chrome                     |


## リソース

RESTにおいて重要な概念の1つである**リソース**とは、Web上に存在する、名前（URI）を持ったありとあらゆる情報のことである。

また、1つのリソースが複数の名前を持つことも可能である。

### アドレス可能性

URIが備える、リソースを簡単に指し示すことができる性質のことを、**アドレス可能性**と呼ぶ。

### リソースの表現と状態

リソースはWeb上に存在する情報という抽象的な概念であるが、実際にサーバとクライアントの間でやり取りされる具体的なデータのことを、**リソースの表現**という。

1つのリソースは複数の表現（HTML形式、PDF形式、画像など）を持つことができる。

リソースには**状態**があり、提供する情報は時間によって変化する可能性がある。

## RESTアーキテクチャスタイル

### クライアント/サーバ

WebはHTTPというプロトコルで**クライアント**と**サーバ**が通信する、**クライアント/サーバ**（Client Server）のアーキテクチャスタイルを採用している。クライアントがサーバに**リクエスト**を送り、サーバはそれに対して**レスポンス**を返す。

このアーキテクチャスタイルの利点は、処理をクライアントとサーバに分離できることである。これにより、クライアントを**マルチプラットフォーム**にすることができる。

また、ユーザインタフェースをクライアントに任せ、サーバはデータストレージとしての機能のみを提供すればよい。複数のサーバを組み合わせて**冗長化**することで、可用性を上げることもできる。

### ステートレスサーバ

**ステートレスサーバ**（Stateless Server）とは、クライアントのアプリケーション状態をサーバで管理しないことを意味する。しかし、現実にはステートレスではないWebサービスやWeb APIは多々ある。HTTPをステートフルにする例は、Cookieを使ったセッション管理である。

Cookieはステートレスサーバの利点をあえて捨てることを理解したうえで、必要最低限に利用する。

### キャッシュ

**キャッシュ**（Cache）は、リソースの鮮度に基づいて、一度取得したリソースをクライアント側で使いまわす方式のこと。

サーバとクライアントの間の通信を減らすことでネットワーク帯域の利用や処理時間を縮小し、より効率的に処理できるようになる。ただし、古いキャッシュを利用してしまい、情報の信頼性が下がる可能性もある。

### 統一インタフェース

**統一インタフェース**（Uniform Interface）とは、URIで指示したリソースに対する操作を統一した限定的なインタフェースで行うこと。

HTTP1.1では、GETやPOSTなど8個のメソッドだけに限定されており、拡張できないという制約がある。柔軟性を犠牲にしたこのような制約により、アーキテクチャ全体をシンプルに保っている。

### 階層化システム

**階層化システム**（Layered System）は、システムをいくつかの階層に分離するアーキテクチャスタイルのことである。

統一インタフェースの恩恵により、Webは非常にシステム全体を階層化しやすくなっている。サーバとクライアントの間に**ロードバランサ**（Load Balancer）を設置して負荷分散をしたり、**プロキシサーバ**（Proxy Server）を設置してアクセスを制限したりすることができる。

これらのサーバやプロキシなどの各コンポーネント間のインタフェースをHTTPで統一しているため、クライアントは接続先の構成が変更されてもそれを意識する必要がない。

### コードオンデマンド

**コードオンデマンド**は、プログラムコードをサーバからダウンロードし、クライアント側でそれを実行するアーキテクチャスタイル。**JavaScript**や**Flash**、**Javaアンプレット**などがこれに該当する。

コードオンデマンドの利点は、クライアントを後から拡張できる点である。一方でコードオンデマンドの欠点は、プログラムをクライアント側で実行することによるアプリケーションプロトコルの可視性の低下である。

### ULCODC$SS

クライアント/サーバにこれらのアーキテクチャスタイルを追加した複合アーキテクチャスタイルは、「**ULCODC$SS**（Uniform Layered Code on Demand Client Cache Stateless Server）」という。このアーキテクチャスタイルのことを、FieldingはRESTと名付けた。

Webサービスを実装するうえでRESTを意識した設計は重要となるが、RESTを構成するスタイルのうちいくつかは除外しても構わない。

## RESTful

### RESTfulサービス

RESTの制約に従っていてRESTらしいサービスのことを**RESTful**と呼ぶ。個別のWebサービスやWeb APIがRESTfulになると、Webは全体としてより良くなる。

Web上のリソース同士が持つリンクをたどる作業を経ることでアプリケーションを実現すること（ソーシャルブックマークサービスなど）を、RESTでは**アプリケーション状態エンジンとしてのハイパーメディア**と呼ぶ。

リソースをリンクで接続することで1つのアプリケーションを構成するという考え方は、**接続性**という。
